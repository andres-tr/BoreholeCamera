<launch>
  
   <param name="/use_sim_time" value="True"/>
   <arg name="path" default="/home/parallels/" />
   <arg name="file_1" default="2022-03-02-15-26-25" />

   <node pkg="rosbag" type="play" name="player" args="--clock -s 130 $(arg path)$(arg file_1).bag" />
  
   <node pkg="tf" type="static_transform_publisher" name="link1_broadcaster" args="0 0 0 0 0 0 base_footprint imu 400" />

   <node pkg="tf" type="static_transform_publisher" name="link2_broadcaster" args="0 0 0  0 0 0 base_footprint odom 400" />

   <node pkg="tf" type="static_transform_publisher" name="link3_broadcaster" args="0 0 0  0 0 0 base_footprint temp 400" />

   <node pkg="robot_pose_ekf" type="robot_pose_ekf" name="robot_pose_ekf" output="screen">
     <param name="output_frame" value="odom_combined"/>
     <param name="freq" value="30"/>
     <param name="odom_used" value="false"/>
     <param name="imu_used" value="true"/>
     <param name="vo_used" value="true"/>
     <param name="debug" value="true"/>
     <remap from="vo" to="/odom" />
     <remap from="imu_data" to="imu/data_wtimeout" />
   
   </node>

   <node name="path_node" pkg="path_node"  type="path_node.py" output="screen"/>

   <node pkg="imu_filter_madgwick" type="imu_filter_node" name="imu_filter_node" output="screen" args="_world_frame:=enu _use_mag:=true _use_magnetic_fld_msg:=true _publish_debug_topics:=true _publish_tf:=false stateless:=false">
    	<param name="use_enu" value="true"/>
    	<param name="mag_bias_x" value="0.00000766129"/>
    	<param name="mag_bias_y" value="0.0000608225"/>
    	<param name="mag_bias_z" value="0.0000288961"/>
    	<param name="zeta" value="0.0"/>
        <remap from="imu/data_raw" to="imu/data_wbias" />
   </node>

   <param name="imu/acc_bias_x" value="0.979259012278" />
   <param name="imu/acc_bias_y" value="0.470187894716" />
   <param name="imu/acc_bias_z" value="0.1053457812" />
   
   <node name="calibration" pkg="calibration"  type="rosbag_acc_bias.py" output="screen"/>
   
   <node name="imu_timeout" pkg="imu"  type="imu_timeout.py" output="screen"/>
</launch>
